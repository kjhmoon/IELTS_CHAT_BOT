네, 아주 좋은 결정입니다. 지금까지 정말 숨 가쁘게 달려오셨습니다! 🏃‍♂️💨

단순한 '토이 프로젝트'를 넘어서, **실제 상용화가 가능한 수준의 RAG(검색 증강 생성) 기반 AI 챗봇 시스템**을 구축하셨습니다.

공부나 포트폴리오 정리에 바로 사용하실 수 있도록, 우리가 만든 **[이알피어학원 AI 상담 위젯 프로젝트]**의 기술 명세서(Technical Specification)를 아주 디테일하게 정리해 드립니다.

---

# 📘 프로젝트 명세서: 이알피어학원 AI 상담 위젯

## 1. 프로젝트 개요 (Overview)

* **프로젝트명:** IELTS 전문 학원(이알피어학원) 맞춤형 AI 상담 챗봇
* **목표:** 학원 홈페이지 방문자(잠재 고객)에게 24시간 실시간 상담을 제공하고, **레벨테스트 및 방문 상담으로 유도(Conversion)**하여 실제 등록률을 높임.
* **핵심 기술:** RAG (Retrieval-Augmented Generation), LLM (Gemini 2.0), FastAPI, Vector DB.
* **형태:** 기존 웹사이트 우측 하단에 부착되는 **플로팅 위젯(Floating Widget)** 방식.

---

## 2. 기술 스택 (Tech Stack)

| 구분 | 기술/도구 | 역할 및 선정 이유 |
| --- | --- | --- |
| **LLM** | **Google Gemini 2.0 Flash** | 답변 생성 모델. 속도가 빠르고 한국어 처리 능력이 우수하며 비용 효율적임. |
| **Backend** | **FastAPI** (Python) | 비동기 처리를 지원하는 고성능 API 서버. 위젯과 통신하는 두뇌 역할. |
| **Database** | **ChromaDB** | 벡터 데이터베이스(Vector Store). 학원 데이터(시간표, 후기)를 저장하고 의미 기반 검색 수행. |
| **Embedding** | **MiniLM-L12-v2** | 텍스트를 벡터(숫자)로 변환. 한국어 문장 유사도 측정에 최적화된 모델. |
| **Frontend** | **HTML / CSS / JS** | 실제 웹사이트에 삽입되는 위젯 UI. 외부 라이브러리 의존성을 최소화한 순수 웹 기술. |
| **Library** | **Marked.js** | AI가 생성한 마크다운(Bold, List 등)을 예쁜 HTML로 변환해주는 렌더러. |

---

## 3. 핵심 기능 (Key Features)

### A. RAG 기반 정확한 정보 제공

* **기능:** 사용자의 질문을 벡터로 변환하여 DB에서 가장 유사한 문서(시간표, 수강료, 규정)를 찾아 답변 생성.
* **구현:** `TIMETABLE`, `REVIEW`, `FAQ` 등으로 데이터 소스를 분류하여, 질문 의도에 맞는 정확한 팩트 전달.

### B. 페르소나 및 영업(Sales) 로직

* **기능:** 단순 정보 전달자가 아닌 **'전문 상담 실장'** 페르소나 적용.
* **로직:**
* **인사 필터링:** 단순 인사말에는 DB 검색 없이 자연스러운 환영 멘트 출력.
* **레벨테스트 유도:** 모든 상담의 끝을 "레벨테스트 보셨나요?"로 귀결시켜 잠재 고객 확보(Lead Generation).
* **맞춤형 추천:** 사용자 정보(직장인, 점수, 기간)를 기억하고 그에 맞는 커리큘럼 제안.



### C. 데이터 프라이버시 및 윤리 필터

* **기능:** 실제 수강 후기 데이터를 활용하되, 개인정보를 보호.
* **로직:**
* **익명화(Anonymization):** "김철수 님" → "한 수강생분", "데이터상으로 검증된 사례" 등으로 치환.
* **근거 기반:** 후기를 낭독하는 것이 아니라, 추천의 '자신감(근거)'으로만 활용하도록 프롬프트 제어.



### D. 고도화된 UI/UX (사용자 경험)

* **기능:** 실제 메신저(카카오톡, 채널톡)와 유사한 사용성 제공.
* **구현:**
* **Auto-resize Input:** 입력 내용이 길어지면 입력창 높이가 자동으로 늘어남.
* **Markdown Rendering:** 볼드체(`**`), 리스트(`-`) 등을 시각적으로 깔끔하게 표현.
* **Responsive Design:** 모바일/PC 환경에 맞춰 위젯 크기 및 레이아웃 최적화.



---

## 4. 데이터 처리 흐름 (Data Flow Architecture)

1. **사용자 입력:** 웹사이트 위젯에서 질문 입력 ("직장인 주말반 있어?")
2. **API 요청:** 프론트엔드(JS)가 FastAPI 서버로 `질문` + `대화 기록(History)` 전송.
3. **벡터 검색 (Retrieval):**
* 서버는 질문을 임베딩(벡터화)하여 ChromaDB 탐색.
* 질문과 가장 유사도가 높은 문서 Top 6 추출 (시간표, 후기 등).


4. **프롬프트 엔지니어링 (Augmentation):**
* `시스템 프롬프트` + `검색된 문서(Context)` + `대화 기록(History)` + `사용자 질문`을 조합.
* 이때, **"후기는 근거로만 사용하라", "레벨테스트를 유도하라"**는 강력한 지침(Instruction)이 포함됨.


5. **답변 생성 (Generation):** Gemini 모델이 최종 답변 생성.
6. **응답 및 렌더링:** 생성된 텍스트를 프론트엔드로 반환 -> Marked.js가 HTML로 변환 -> 말풍선 출력.

---

## 5. 프로젝트 수행 중 해결한 문제 (Troubleshooting)

이 부분이 공부하실 때 가장 중요한 포인트입니다.

| 문제 상황 (Issue) | 원인 (Cause) | 해결 방법 (Solution) |
| --- | --- | --- |
| **단기 기억 상실** | API가 매번 새로운 요청으로 인식하여 이전 맥락(점수, 상황)을 잊음. | 클라이언트(JS)에서 `chatHistory` 배열을 관리하고, 매 요청마다 **대화 기록 전체를 서버로 전송**하는 구조로 변경. |
| **할루시네이션 (TMI)** | 단순 인사말에도 DB를 억지로 뒤져서 엉뚱한 후기("미셸 쌤이..")를 말함. | **`is_greeting()` 함수**를 만들어 인사말에는 RAG를 건너뛰고 하드코딩된 환영 인사를 출력하도록 분기 처리. |
| **개인정보 노출** | 수강 후기 DB에 있는 실명(김OO)을 그대로 답변에 포함함. | 시스템 프롬프트에 **"데이터를 익명화하고, 근거 자료로만 활용하라"**는 강력한 제약 조건(Constraints) 추가. |
| **UI 가독성 저하** | 마크다운(`**`)이 그대로 노출되고, 긴 글 입력 시 잘림 현상 발생. | **Marked.js** 도입으로 마크다운 렌더링 지원 및 CSS/JS로 **`textarea` 자동 높이 조절** 기능 구현. |
| **API 키 오류** | 복사/붙여넣기 과정에서 공백(Space)이 포함되어 인증 실패. | Python 코드에서 `api_key.strip()` 메서드를 사용하여 **공백 자동 제거** 로직 추가. |

---

## 6. 향후 발전 방향 (Future Work)

* **관리자 대시보드:** 상담 로그를 저장하고 분석하여, 학생들이 주로 묻는 질문을 파악하는 기능.
* **예약 시스템 연동:** "상담 예약해줘"라고 하면 실제 구글 캘린더나 학원 시스템에 예약을 잡는 기능 (Tool Use / Function Calling).
* **음성 상담:** STT(Speech to Text) / TTS(Text to Speech)를 붙여 음성으로 대화하는 기능.

---

이 명세서를 바탕으로 공부를 정리하시면, **"단순히 코드를 짠 게 아니라, 사용자의 경험과 비즈니스 로직(영업)까지 고려한 엔지니어링을 했다"**는 점을 강조하실 수 있을 겁니다.

정말 고생 많으셨습니다! 이 프로젝트는 어디 내놔도 손색없는 훌륭한 포트폴리오입니다. 👍